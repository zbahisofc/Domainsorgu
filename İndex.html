<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Domain Chacker</title>
  <style>
    /* Basit, Koyu Tema + Neon Vibe (Başlıklar Title Case) */
    :root{
      --bg:#0b0f0c;
      --card:rgba(255,255,255,0.03);
      --accent:#A9EE16;
      --muted:#9aa0a6;
      --danger:#ff4d4f;
      --good:#00d080;
    }
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    body{
      background: linear-gradient(180deg,#050606 0%, #07110b 60%);
      color:var(--accent);
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:28px;
      gap:20px;
    }
    .container{
      width:100%;
      max-width:940px;
      background:transparent;
    }
    header{
      display:flex;
      align-items:center;
      gap:16px;
      margin-bottom:14px;
    }
    .logo{
      width:64px;height:64px;border-radius:10px;
      background:linear-gradient(135deg,#0f1b0a,#183009);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 6px 20px rgba(0,0,0,0.6),0 0 12px rgba(169,238,22,0.08);
      font-weight:800;color:#07110b;
      font-size:18px;
    }
    h1{margin:0;font-size:20px;color:#CFFF7A;letter-spacing:0.6px;}
    p.lead{margin:6px 0 0;color:var(--muted);font-size:13px;}
    .card{
      background:var(--card);padding:18px;border-radius:12px;backdrop-filter:blur(6px);
      box-shadow:0 8px 30px rgba(0,0,0,0.6);
    }

    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;}
    input[type="text"], input[type="number"], select{
      padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);
      background:#070a08;color:var(--accent);min-width:120px;
      outline:none;font-size:14px;
    }
    button{
      padding:10px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:700;
      background:linear-gradient(90deg,#A9EE16,#85d000);color:#04110a;
      box-shadow:0 6px 18px rgba(169,238,22,0.08);
    }
    button.secondary{
      background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04);
    }

    #results{margin-top:18px;max-height:520px;overflow:auto;padding:10px;border-radius:10px;}
    .row{display:flex;align-items:center;justify-content:space-between;padding:10px;border-radius:8px;margin-bottom:8px;background:linear-gradient(180deg, rgba(255,255,255,0.008), rgba(255,255,255,0.004));}
    .domain{font-weight:700;color:var(--accent);}
    .status{font-size:13px;}
    .available{color:var(--good);font-weight:700;}
    .registered{color:var(--danger);font-weight:700;}
    .muted{color:var(--muted);font-size:13px;}
    .small{font-size:12px;color:var(--muted);margin-top:6px;}
    footer{margin-top:14px;color:var(--muted);font-size:12px;text-align:center;}
    .badge{padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.02);color:var(--muted);font-size:13px;}
    .flex{display:flex;gap:8px;align-items:center;}
    @media (max-width:640px){
      header{gap:10px}
      .logo{width:52px;height:52px;font-size:16px}
      .controls{flex-direction:column;align-items:stretch}
      input[type="text"], input[type="number"]{width:100%}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">DC</div>
      <div>
        <h1>Domain Chacker</h1>
        <p class="lead">Hızlı Ve Basit Whois Tabanlı Domain Aralığı Kontrolü (WhoisJSON API).</p>
      </div>
      <div style="margin-left:auto" class="badge">Title Case UI</div>
    </header>

    <div class="card">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div style="flex:1;min-width:220px">
          <div class="small">Api Key (WhoisXmlapi Veya Benzeri)</div>
          <input id="apiKey" type="text" placeholder="Api Key Girin (Zorunlu)" />
        </div>

        <div style="flex:1;min-width:220px">
          <div class="small">Prefix</div>
          <input id="prefix" type="text" placeholder="Ör: zbahis" value="zbahis" />
        </div>

        <div style="display:flex;gap:8px;align-items:center">
          <div>
            <div class="small">Start</div>
            <input id="start" type="number" placeholder="300" value="300" />
          </div>
          <div>
            <div class="small">End</div>
            <input id="end" type="number" placeholder="500" value="305" />
          </div>
        </div>

        <div style="min-width:120px">
          <div class="small">Tld</div>
          <input id="tld" type="text" placeholder="com" value="com" />
        </div>

        <div style="min-width:160px">
          <div class="small">Delay (Ms)</div>
          <input id="delay" type="number" placeholder="200" value="200" />
        </div>
      </div>

      <div class="controls" style="margin-top:12px">
        <button id="startBtn">Sorgula</button>
        <button class="secondary" id="stopBtn" disabled>Dur</button>
        <button class="secondary" id="downloadBtn">Csv İndir</button>
        <div class="muted" style="margin-left:auto">WhoisXmlapi Uyumlu Json Dönüşü Bekler</div>
      </div>

      <div id="results"></div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px">
        <div class="small">Toplam: <span id="totalCount">0</span></div>
        <div class="small">Boş: <span id="availableCount">0</span> • Kayıtlı: <span id="registeredCount">0</span></div>
      </div>
    </div>

    <footer>
      Domain Chacker © 2025 — WhoisXmlapi Veya Benzeri Api Kullanılarak Çalışır. <br>
      Lütfen Api Key'i Güvenli Tutun. Rate Limit Ve Kullanım Koşullarına Dikkat Edin.
    </footer>
  </div>

  <script>
    // Domain Chacker - GitHub Pages Friendly Single File
    // Kullanım: index.html'yi Repo'na At, Settings -> Pages -> Deploy Et
    // API: WhoisXMLApi Veya Whois Json Döndüren Herhangi Bir Servisle Çalışır
    // Önemli: Api Key'i Here Yazma; Tarayıcıda Gelen Key Herkes Tarafından Görülebilir.
    // Eğer Gizli Tutmak İstersen Backend Proxy Koy (Replit / Render / Vercel).

    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const resultsEl = document.getElementById('results');
    const totalCountEl = document.getElementById('totalCount');
    const availableCountEl = document.getElementById('availableCount');
    const registeredCountEl = document.getElementById('registeredCount');

    let stopped = false;
    let resultsData = [];

    function titleCase(s){ return s.replace(/\w\S*/g, (txt)=>txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()); }

    startBtn.addEventListener('click', async () => {
      stopped = false;
      startBtn.disabled = true;
      stopBtn.disabled = false;
      resultsEl.innerHTML = '';
      resultsData = [];
      totalCountEl.textContent = '0';
      availableCountEl.textContent = '0';
      registeredCountEl.textContent = '0';

      const apiKey = document.getElementById('apiKey').value.trim();
      const prefix = document.getElementById('prefix').value.trim();
      const start = parseInt(document.getElementById('start').value,10);
      const end = parseInt(document.getElementById('end').value,10);
      const tld = document.getElementById('tld').value.trim() || 'com';
      const delay = parseInt(document.getElementById('delay').value,10) || 200;

      if (!apiKey) { alert('Lütfen Api Key Girin.'); startBtn.disabled = false; stopBtn.disabled = true; return; }
      if (!prefix || isNaN(start) || isNaN(end) || start > end) { alert('Lütfen Geçerli Prefix ve Numeric Aralık Girin.'); startBtn.disabled = false; stopBtn.disabled = true; return; }

      // Loop
      for (let i = start; i <= end; i++){
        if (stopped) break;
        const domain = `${prefix}${i}.${tld}`;
        appendLoading(domain);
        try {
          // WhoisXmlapi Endpoint (Json)
          // Örnek: https://www.whoisxmlapi.com/whoisserver/WhoisService?apiKey=APIKEY&domainName=DOMAIN&outputFormat=JSON
          // Eğer Farklı Bir Api Kullanacaksaniz Url'i Burada Değiştirin.
          const url = `https://www.whoisxmlapi.com/whoisserver/WhoisService?apiKey=${encodeURIComponent(apiKey)}&domainName=${encodeURIComponent(domain)}&outputFormat=JSON`;
          const resp = await fetch(url);
          if (!resp.ok) {
            // 4xx/5xx -> Denetle
            updateRow(domain, 'error', `Http ${resp.status}`);
            resultsData.push({domain, status:'error', info:`Http ${resp.status}`});
            await sleep(delay);
            continue;
          }
          const data = await resp.json();

          // Örnek Api Yanıtını İnceledik: data.WhoisRecord.domainAvailability / data.WhoisRecord.dataError
          const wr = data && data.WhoisRecord ? data.WhoisRecord : null;

          if (!wr) {
            // Bilinmeyen Format
            updateRow(domain, 'unknown', 'No WhoisRecord');
            resultsData.push({domain, status:'unknown', info:'No WhoisRecord'});
          } else {
            // 1) Eğer domainAvailability Alanı Varsa Direkt Kullan
            // 2) Varsa dataError === "MISSING_WHOIS_DATA" -> Boş
            // 3) Aksi Halde Kayıtlı
            const availability = wr.domainAvailability ? String(wr.domainAvailability).toUpperCase() : null;
            const dataError = wr.dataError ? String(wr.dataError).toUpperCase() : null;

            if (availability === 'UNAVAILABLE' || availability === 'REGISTERED') {
              updateRow(domain,'registered', availability);
              resultsData.push({domain, status:'registered', info:availability});
            } else if (availability === 'AVAILABLE' || dataError === 'MISSING_WHOIS_DATA' || availability === 'AVAILABLE') {
              updateRow(domain,'available', availability || dataError || 'available');
              resultsData.push({domain, status:'available', info:availability || dataError || 'available'});
            } else {
              // Fallback: Eğer whois içinde created/registrar vb. varsa kayıtlı say
              if (wr.createdDate || wr.registrarName || wr.registrant) {
                updateRow(domain,'registered','whois-info-found');
                resultsData.push({domain, status:'registered', info:'whois-info-found'});
              } else {
                updateRow(domain,'available','no-whois-and-no-dates');
                resultsData.push({domain, status:'available', info:'no-whois-and-no-dates'});
              }
            }
          }
        } catch (err){
          updateRow(domain,'error', err.message || 'fetch-error');
          resultsData.push({domain, status:'error', info:err.message || 'fetch-error'});
        }
        totalCountEl.textContent = resultsData.length;
        availableCountEl.textContent = resultsData.filter(r=>r.status==='available').length;
        registeredCountEl.textContent = resultsData.filter(r=>r.status==='registered').length;
        await sleep(delay);
      }

      startBtn.disabled = false;
      stopBtn.disabled = true;
    });

    stopBtn.addEventListener('click', () => {
      stopped = true;
      startBtn.disabled = false;
      stopBtn.disabled = true;
    });

    downloadBtn.addEventListener('click', () => {
      if (!resultsData || resultsData.length===0) { alert('Henüz Sonuç Yok'); return; }
      const rows = [['Domain','Status','Info']];
      resultsData.forEach(r => rows.push([r.domain, r.status, (r.info||'')]));
      const csv = rows.map(r => r.map(cell => `"${String(cell).replace(/"/g,'""')}"`).join(',')).join('\n');
      const blob = new Blob([csv],{type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'domain-chacker-results.csv';
      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    function appendLoading(domain){
      const el = document.createElement('div');
      el.className = 'row';
      el.id = `row-${escapeId(domain)}`;
      el.innerHTML = `<div><div class="domain">${domain}</div><div class="muted">Sorgulanıyor...</div></div><div class="status muted">⏳</div>`;
      resultsEl.prepend(el);
    }

    function updateRow(domain, status, info){
      const id = `row-${escapeId(domain)}`;
      let el = document.getElementById(id);
      if (!el){
        el = document.createElement('div'); el.className='row'; el.id=id; resultsEl.prepend(el);
      }
      let statusHtml = '';
      if (status==='available') statusHtml = `<span class="available">✅ Boş</span>`;
      else if (status==='registered') statusHtml = `<span class="registered">❌ Kayıtlı</span>`;
      else if (status==='error') statusHtml = `<span class="muted">⚠️ Hata</span>`;
      else statusHtml = `<span class="muted">${escapeHtml(String(status))}</span>`;
      el.innerHTML = `<div><div class="domain">${escapeHtml(domain)}</div><div class="muted">${escapeHtml(String(info || ''))}</div></div><div class="status">${statusHtml}</div>`;
    }

    function sleep(ms){ return new Promise(res=>setTimeout(res,ms)); }
    function escapeHtml(s){ return (s||'').replace(/[&<>"']/g, (c)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
    function escapeId(s){ return s.replace(/[^a-z0-9_-]/gi,'_'); }

  </script>
</body>
</html>
